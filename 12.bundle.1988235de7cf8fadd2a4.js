(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"38gM":function(e,t,n){"use strict";n.r(t),n.d(t,"ArticlePage",(function(){return X}));var a=n("mXGw"),r=n.n(a),c=n("dY8W"),o=n("nOdE"),l=n("TW3H"),u=n("UYjC"),i=n("USb2"),m=n("rPMT"),s=n("SugE"),f=n("xArF"),b=n("eZyy");function d(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return O(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var E=Object(s.d)(),p=Object(s.c)((function(e){return b.a.get("articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))})),g=Object(s.c)((function(e){var t=e.slug,n=e.body;return b.a.post("articles/".concat(t,"/comments"),{body:n}).then((function(e){return e.data.comment}))})),j=Object(s.c)((function(e){var t=e.slug,n=e.id;return b.a.delete("articles/".concat(t,"/comments/").concat(n))})),v=Object(c.a)(),y=v.state.map((function(e){return e.slug})),h=Object(s.e)([]).on(p.doneData,(function(e,t){return t})).on(g.doneData,(function(e,t){return[t].concat(d(e))})).on(j.done,(function(e,t){var n=t.params;return e.filter((function(e){return e.id!==n.id}))})),w=Object(f.a)({fields:{comment:{init:""}}});Object(s.f)({from:y.updates,to:Object(s.a)({source:y,effect:p})}),Object(s.f)({from:w.submit,to:Object(s.a)({source:{slug:y,body:w.fields.comment.$value},effect:g})}),Object(s.f)({from:g,to:w.reset}),Object(s.i)({source:y,clock:E,fn:function(e,t){return{slug:e,id:t}},target:j});var N=Object(s.e)({errors:{}}).on([g.failData,j.failData],(function(e,t){var n;return null===(n=t.response)||void 0===n?void 0:n.data})).reset(w.$touched),A=n("Szyw"),S=function(e){var t=e.onClick;return r.a.createElement(u.b,{className:"mod-options btn-delete",onClick:t},r.a.createElement("i",{className:"ion-trash-a"}))},k=function(e){var t=e.author,n=e.createdAt,a=e.id,o=Object(c.d)(A.a.$user).username===t.username;return r.a.createElement("div",{className:"card-footer"},r.a.createElement(i.a,{className:"comment-author",to:"/@".concat(t.username)},r.a.createElement("img",{alt:t.username,className:"comment-author-img",src:t.image}))," ",r.a.createElement(i.a,{className:"comment-author",to:"/@".concat(t.username)},t.username),r.a.createElement("span",{className:"date-posted"},new Date(n).toDateString()),r.a.createElement(m.a,{check:"auth"},o&&r.a.createElement(S,{onClick:function(){return E(a)}})))},D=function(e){var t=e.comment;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-block"},r.a.createElement("p",{className:"card-text"},t.body)),r.a.createElement(k,t))},P=function(){return r.a.createElement(u.i,null,Object(c.c)(h,(function(e){return r.a.createElement(D,{comment:e})})))},C=function(){var e=Object(c.d)(N);return r.a.createElement(u.d,{errors:e})},x=function(){var e=Object(c.d)(A.a.$user),t=e.image,n=e.username;return r.a.createElement("div",{className:"card-footer"},r.a.createElement("img",{alt:n,className:"comment-author-img",src:t}),r.a.createElement(u.b,{className:"btn-sm btn-primary",type:"submit"},"Post Comment"))},$=function(){var e=Object(f.c)(w),t=e.submit,n=e.fields;return r.a.createElement(u.e,{className:"card comment-form",onSubmit:function(e){e.preventDefault(),t()}},r.a.createElement("div",{className:"card-block"},r.a.createElement(u.s,{placeholder:"Write a comment...",rows:3,value:n.comment.value,onChange:function(e){return n.comment.onChange(e.target.value)}})),r.a.createElement(x,null))},I=function(e){var t=e.slug;return Object(c.b)(v,{slug:t}),r.a.createElement("div",{className:"col-xs-12 col-md-8 offset-md-2"},r.a.createElement(m.a,{check:"auth"},r.a.createElement(C,null),r.a.createElement($,null)),r.a.createElement(m.a,{check:"anon"},r.a.createElement("p",null,r.a.createElement(i.a,{to:"/login"},"Sign in")," or ",r.a.createElement(i.a,{to:"/register"},"sign up")," to add comments on this article.")),r.a.createElement(P,null))};function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){M(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function M(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)n=c[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var U=Object(s.d)(),W=Object(s.c)((function(e){return b.a.get("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var t=e.createdAt;return L(L({},T(e,["createdAt"])),{},{createdAt:new Date(t).toDateString()})}))})),J=Object(s.c)((function(e){return b.a.delete("articles/".concat(e))})),Y=Object(c.a)(),q=Y.state.map((function(e){return e.slug})),z=Object(s.e)({title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}).on(W.doneData,(function(e,t){return t})),G=Object(s.b)(z,A.a.$user,(function(e,t){return e.author.username===t.username}));Object(s.f)({from:Y.open,to:Object(s.a)({source:q,effect:W})}),Object(s.f)({from:U,to:Object(s.a)({source:q,effect:J})}),J.done.watch((function(){m.d.history.push("/")}));var H=function(){var e=Object(c.d)(G),t=Object(c.d)(z).slug;return r.a.createElement(r.a.Fragment,null,e&&r.a.createElement("span",null,r.a.createElement(i.a,{to:"/editor/".concat(t)},r.a.createElement(u.b,{className:"btn-sm btn-outline-secondary"},r.a.createElement("i",{className:"ion-edit"})," Edit Article")),r.a.createElement(u.b,{className:"btn-sm btn-outline-danger",onClick:U},r.a.createElement("i",{className:"ion-trash-a"})," Delete Article")))},X=function(e){var t=e.match.params.slug;Object(c.b)(Y,{slug:t});var n=Object(c.d)(z),a=n.title,i=n.author,m=n.createdAt,s=n.body,f=n.tagList,b=Object(c.d)(W.pending);return r.a.createElement(r.a.Fragment,null,!b&&r.a.createElement("div",{className:"article-page"},r.a.createElement(u.a,null,r.a.createElement(u.c,null,r.a.createElement("h1",null,a),r.a.createElement(l.a,{author:i,createdAt:m},r.a.createElement(H,null)))),r.a.createElement(u.l,null,r.a.createElement(u.n,{className:"article-content"},r.a.createElement("div",{className:"col-xs-12"},r.a.createElement(o.a,null,s),r.a.createElement(u.q,null,f.map((function(e){return r.a.createElement(u.p,{key:e},e.toLowerCase())}))))),r.a.createElement("hr",null),r.a.createElement("div",{className:"article-actions"}),r.a.createElement(u.n,null,r.a.createElement(I,{slug:t}),r.a.createElement("div",null)))))}}}]);