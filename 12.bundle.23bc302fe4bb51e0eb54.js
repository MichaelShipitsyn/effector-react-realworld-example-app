(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"38gM":function(e,t,r){"use strict";r.r(t),r.d(t,"ArticlePage",(function(){return G}));var n=r("dY8W"),c=r("nOdE"),a=r("VU9o"),o=r("UYjC"),s=r("USb2"),i=r("rPMT"),u=r("SugE"),j=r("xArF"),l=r("eZyy");function b(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return d(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O=Object(u.d)(),f=Object(u.c)((function(e){return l.a.get("articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))})),m=Object(u.c)((function(e){var t=e.slug,r=e.body;return l.a.post("articles/".concat(t,"/comments"),{body:r}).then((function(e){return e.data.comment}))})),h=Object(u.c)((function(e){var t=e.slug,r=e.id;return l.a.delete("articles/".concat(t,"/comments/").concat(r))})),p=Object(n.a)(),g=p.state.map((function(e){return e.slug})),x=Object(u.i)(f.doneData,[]).on(m.doneData,(function(e,t){return[t].concat(b(e))})).on(h.done,(function(e,t){var r=t.params;return e.filter((function(e){return e.id!==r.id}))})),y=Object(j.a)({fields:{comment:{init:""}}});Object(u.f)({from:g.updates,to:Object(u.a)({source:g,effect:f})}),Object(u.f)({from:y.submit,to:Object(u.a)({source:{slug:g,body:y.fields.comment.$value},effect:m})}),Object(u.f)({from:m,to:y.reset}),Object(u.j)({source:g,clock:O,fn:function(e,t){return{slug:e,id:t}},target:h});var v=Object(u.e)({errors:{}}).on([m.failData,h.failData],(function(e,t){var r;return null===(r=t.response)||void 0===r?void 0:r.data})).reset(y.$touched),w=r("/6P/"),N=r("oYCi"),P=function(e){var t=e.onClick;return Object(N.jsx)(o.b,{className:"mod-options btn-delete",onClick:t,children:Object(N.jsx)("i",{className:"ion-trash-a"})})},A=function(e){var t=e.author,r=e.createdAt,c=e.id,a=Object(n.d)(w.a.$user).username===t.username;return Object(N.jsxs)("div",{className:"card-footer",children:[Object(N.jsx)(s.a,{className:"comment-author",to:"/@".concat(t.username),children:Object(N.jsx)("img",{alt:t.username,className:"comment-author-img",src:t.image})})," ",Object(N.jsx)(s.a,{className:"comment-author",to:"/@".concat(t.username),children:t.username}),Object(N.jsx)("span",{className:"date-posted",children:new Date(r).toDateString()}),Object(N.jsx)(i.a,{check:"auth",children:a&&Object(N.jsx)(P,{onClick:function(){return O(c)}})})]})};function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function S(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach((function(t){k(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function k(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var C=function(e){var t=e.comment;return Object(N.jsxs)("div",{className:"card",children:[Object(N.jsx)("div",{className:"card-block",children:Object(N.jsx)("p",{className:"card-text",children:t.body})}),Object(N.jsx)(A,S({},t))]})},E=function(){return Object(N.jsx)(o.i,{children:Object(n.c)(x,{getKey:function(e){return e.id},fn:function(e){return Object(N.jsx)(C,{comment:e})}})})},$=function(){var e=Object(n.d)(v);return Object(N.jsx)(o.d,{errors:e})},I=function(){var e=Object(n.d)(w.a.$user),t=e.image,r=e.username;return Object(N.jsxs)("div",{className:"card-footer",children:[Object(N.jsx)("img",{alt:r,className:"comment-author-img",src:t}),Object(N.jsx)(o.b,{className:"btn-sm btn-primary",type:"submit",children:"Post Comment"})]})},U=function(){var e=Object(j.c)(y),t=e.submit,r=e.fields;return Object(N.jsxs)(o.e,{className:"card comment-form",onSubmit:function(e){e.preventDefault(),t()},children:[Object(N.jsx)("div",{className:"card-block",children:Object(N.jsx)(o.s,{placeholder:"Write a comment...",rows:3,value:r.comment.value,onChange:function(e){return r.comment.onChange(e.target.value)}})}),Object(N.jsx)(I,{})]})},F=function(e){var t=e.slug;return Object(n.b)(p,{slug:t}),Object(N.jsxs)("div",{className:"col-xs-12 col-md-8 offset-md-2",children:[Object(N.jsxs)(i.a,{check:"auth",children:[Object(N.jsx)($,{}),Object(N.jsx)(U,{})]}),Object(N.jsx)(i.a,{check:"anon",children:Object(N.jsxs)("p",{children:[Object(N.jsx)(s.a,{to:"/login",children:"Sign in"})," or ",Object(N.jsx)(s.a,{to:"/register",children:"sign up"})," to add comments on this article."]})}),Object(N.jsx)(E,{})]})};function L(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function M(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?L(Object(r),!0).forEach((function(t){Y(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Y(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function J(e,t){if(null==e)return{};var r,n,c=function(e,t){if(null==e)return{};var r,n,c={},a=Object.keys(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||(c[r]=e[r]);return c}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(c[r]=e[r])}return c}var T=Object(u.d)(),W=Object(u.c)((function(e){return l.a.get("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var t=e.createdAt;return M(M({},J(e,["createdAt"])),{},{createdAt:new Date(t).toDateString()})}))})),q=Object(u.c)((function(e){return l.a.delete("articles/".concat(e))})),K=Object(n.a)(),V=K.state.map((function(e){return e.slug})),Z=Object(u.i)(W.doneData,{title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}),z=Object(u.b)(Z,w.a.$user,(function(e,t){return e.author.username===t.username}));Object(u.f)({from:K.open,to:Object(u.a)({source:V,effect:W})}),Object(u.f)({from:T,to:Object(u.a)({source:V,effect:q})}),q.done.watch((function(){i.d.history.push("/")}));var B=function(){var e=Object(n.d)(z),t=Object(n.d)(Z).slug;return Object(N.jsx)(N.Fragment,{children:e&&Object(N.jsxs)("span",{children:[Object(N.jsx)(s.a,{to:"/editor/".concat(t),children:Object(N.jsxs)(o.b,{className:"btn-sm btn-outline-secondary",children:[Object(N.jsx)("i",{className:"ion-edit"})," Edit Article"]})}),Object(N.jsxs)(o.b,{className:"btn-sm btn-outline-danger",onClick:T,children:[Object(N.jsx)("i",{className:"ion-trash-a"})," Delete Article"]})]})})},G=function(e){var t=e.match.params.slug;Object(n.b)(K,{slug:t});var r=Object(n.d)(Z),s=r.title,i=r.author,u=r.createdAt,j=r.body,l=r.tagList,b=Object(n.d)(W.pending);return Object(N.jsx)(N.Fragment,{children:!b&&Object(N.jsxs)("div",{className:"article-page",children:[Object(N.jsx)(o.a,{children:Object(N.jsxs)(o.c,{children:[Object(N.jsx)("h1",{children:s}),Object(N.jsx)(a.a,{author:i,createdAt:u,children:Object(N.jsx)(B,{})})]})}),Object(N.jsxs)(o.l,{children:[Object(N.jsx)(o.n,{className:"article-content",children:Object(N.jsxs)("div",{className:"col-xs-12",children:[Object(N.jsx)(c.a,{children:j}),Object(N.jsx)(o.q,{children:l.map((function(e){return Object(N.jsx)(o.p,{children:e.toLowerCase()},e)}))})]})}),Object(N.jsx)("hr",{}),Object(N.jsx)("div",{className:"article-actions"}),Object(N.jsxs)(o.n,{children:[Object(N.jsx)(F,{slug:t}),Object(N.jsx)("div",{})]})]})]})})}}}]);