(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{"38gM":function(e,t,a){"use strict";a.r(t),a.d(t,"ArticlePage",(function(){return Z}));var n=a("mXGw"),r=a.n(n),c=a("dY8W"),o=a("nOdE"),l=a("VU9o"),u=a("UYjC"),i=a("USb2"),m=a("rPMT"),s=a("SugE"),f=a("xArF"),b=a("eZyy");function d(e){return function(e){if(Array.isArray(e))return O(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return O(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return O(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function O(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var E=Object(s.d)(),p=Object(s.c)((function(e){return b.a.get("articles/".concat(e,"/comments")).then((function(e){return e.data.comments}))})),g=Object(s.c)((function(e){var t=e.slug,a=e.body;return b.a.post("articles/".concat(t,"/comments"),{body:a}).then((function(e){return e.data.comment}))})),j=Object(s.c)((function(e){var t=e.slug,a=e.id;return b.a.delete("articles/".concat(t,"/comments/").concat(a))})),v=Object(c.a)(),y=v.state.map((function(e){return e.slug})),h=Object(s.i)(p.doneData,[]).on(g.doneData,(function(e,t){return[t].concat(d(e))})).on(j.done,(function(e,t){var a=t.params;return e.filter((function(e){return e.id!==a.id}))})),w=Object(f.a)({fields:{comment:{init:""}}});Object(s.f)({from:y.updates,to:Object(s.a)({source:y,effect:p})}),Object(s.f)({from:w.submit,to:Object(s.a)({source:{slug:y,body:w.fields.comment.$value},effect:g})}),Object(s.f)({from:g,to:w.reset}),Object(s.j)({source:y,clock:E,fn:function(e,t){return{slug:e,id:t}},target:j});var N=Object(s.e)({errors:{}}).on([g.failData,j.failData],(function(e,t){var a;return null===(a=t.response)||void 0===a?void 0:a.data})).reset(w.$touched),A=a("/6P/"),k=function(e){var t=e.onClick;return r.a.createElement(u.b,{className:"mod-options btn-delete",onClick:t},r.a.createElement("i",{className:"ion-trash-a"}))},D=function(e){var t=e.author,a=e.createdAt,n=e.id,o=Object(c.d)(A.a.$user).username===t.username;return r.a.createElement("div",{className:"card-footer"},r.a.createElement(i.a,{className:"comment-author",to:"/@".concat(t.username)},r.a.createElement("img",{alt:t.username,className:"comment-author-img",src:t.image}))," ",r.a.createElement(i.a,{className:"comment-author",to:"/@".concat(t.username)},t.username),r.a.createElement("span",{className:"date-posted"},new Date(a).toDateString()),r.a.createElement(m.a,{check:"auth"},o&&r.a.createElement(k,{onClick:function(){return E(n)}})))},P=function(e){var t=e.comment;return r.a.createElement("div",{className:"card"},r.a.createElement("div",{className:"card-block"},r.a.createElement("p",{className:"card-text"},t.body)),r.a.createElement(D,t))},S=function(){return r.a.createElement(u.i,null,Object(c.c)(h,(function(e){return r.a.createElement(P,{comment:e})})))},C=function(){var e=Object(c.d)(N);return r.a.createElement(u.d,{errors:e})},x=function(){var e=Object(c.d)(A.a.$user),t=e.image,a=e.username;return r.a.createElement("div",{className:"card-footer"},r.a.createElement("img",{alt:a,className:"comment-author-img",src:t}),r.a.createElement(u.b,{className:"btn-sm btn-primary",type:"submit"},"Post Comment"))},$=function(){var e=Object(f.c)(w),t=e.submit,a=e.fields;return r.a.createElement(u.e,{className:"card comment-form",onSubmit:function(e){e.preventDefault(),t()}},r.a.createElement("div",{className:"card-block"},r.a.createElement(u.s,{placeholder:"Write a comment...",rows:3,value:a.comment.value,onChange:function(e){return a.comment.onChange(e.target.value)}})),r.a.createElement(x,null))},I=function(e){var t=e.slug;return Object(c.b)(v,{slug:t}),r.a.createElement("div",{className:"col-xs-12 col-md-8 offset-md-2"},r.a.createElement(m.a,{check:"auth"},r.a.createElement(C,null),r.a.createElement($,null)),r.a.createElement(m.a,{check:"anon"},r.a.createElement("p",null,r.a.createElement(i.a,{to:"/login"},"Sign in")," or ",r.a.createElement(i.a,{to:"/register"},"sign up")," to add comments on this article.")),r.a.createElement(S,null))};function U(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function F(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?U(Object(a),!0).forEach((function(t){L(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):U(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function L(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function M(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},c=Object.keys(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)a=c[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var J=Object(s.d)(),T=Object(s.c)((function(e){return b.a.get("articles/".concat(e)).then((function(e){return e.data.article})).then((function(e){var t=e.createdAt;return F(F({},M(e,["createdAt"])),{},{createdAt:new Date(t).toDateString()})}))})),W=Object(s.c)((function(e){return b.a.delete("articles/".concat(e))})),Y=Object(c.a)(),q=Y.state.map((function(e){return e.slug})),G=Object(s.i)(T.doneData,{title:"",slug:"",body:"",createdAt:"",updatedAt:"",tagList:[],description:"",author:{username:"",bio:"",image:"",following:!1},favorited:!1,favoritesCount:0}),V=Object(s.b)(G,A.a.$user,(function(e,t){return e.author.username===t.username}));Object(s.f)({from:Y.open,to:Object(s.a)({source:q,effect:T})}),Object(s.f)({from:J,to:Object(s.a)({source:q,effect:W})}),W.done.watch((function(){m.d.history.push("/")}));var X=function(){var e=Object(c.d)(V),t=Object(c.d)(G).slug;return r.a.createElement(r.a.Fragment,null,e&&r.a.createElement("span",null,r.a.createElement(i.a,{to:"/editor/".concat(t)},r.a.createElement(u.b,{className:"btn-sm btn-outline-secondary"},r.a.createElement("i",{className:"ion-edit"})," Edit Article")),r.a.createElement(u.b,{className:"btn-sm btn-outline-danger",onClick:J},r.a.createElement("i",{className:"ion-trash-a"})," Delete Article")))},Z=function(e){var t=e.match.params.slug;Object(c.b)(Y,{slug:t});var a=Object(c.d)(G),n=a.title,i=a.author,m=a.createdAt,s=a.body,f=a.tagList,b=Object(c.d)(T.pending);return r.a.createElement(r.a.Fragment,null,!b&&r.a.createElement("div",{className:"article-page"},r.a.createElement(u.a,null,r.a.createElement(u.c,null,r.a.createElement("h1",null,n),r.a.createElement(l.a,{author:i,createdAt:m},r.a.createElement(X,null)))),r.a.createElement(u.l,null,r.a.createElement(u.n,{className:"article-content"},r.a.createElement("div",{className:"col-xs-12"},r.a.createElement(o.a,null,s),r.a.createElement(u.q,null,f.map((function(e){return r.a.createElement(u.p,{key:e},e.toLowerCase())}))))),r.a.createElement("hr",null),r.a.createElement("div",{className:"article-actions"}),r.a.createElement(u.n,null,r.a.createElement(I,{slug:t}),r.a.createElement("div",null)))))}}}]);